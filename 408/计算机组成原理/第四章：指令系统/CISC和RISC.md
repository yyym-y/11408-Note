## 一、指令系统

### 1. 指令系统介绍

指令系统是计算机体系结构的核心组成部分，它定义了 CPU 能够理解和执行的所有操作。其核心要素包括：

* **指令格式设计**：规定了二进制代码如何表示一条指令，包括操作码（表示操作类型）和操作数（表示操作对象）。
* **指令寻址方式**：决定了 CPU 如何定位**下一条要执行的指令**的地址。
* **数据寻址方式**：决定了 CPU 如何定位**操作对象**（数据）的地址。
* **设计特点**：指令系统的设计具有高度灵活性，通常可以通过不同的指令组合来实现相同的功能。

### 2. CISC 和 RISC

计算机的指令集架构主要分为两大类：复杂指令集计算机 (CISC) 和精简指令集计算机 (RISC)。

#### 2.1 CISC (Complex Instruction Set Computer) (01:01)

* **全称**：**C**omplex **I**nstruction **S**et **C**omputer（复杂指令集计算机）。
* **设计理念**：
    * **功能集成**：追求单条指令能够完成非常复杂的功能，例如一条指令就能完成矩阵乘法或字符串处理。
    * **硬件实现**：复杂的指令通常通过**专用电路**实现，或者部分更复杂的指令会采用“**存储程序**”思想，即通过微程序（一系列更简单的微指令）来执行。
* **典型应用**：**x86 架构**是 CISC 的典型代表，广泛应用于个人电脑、服务器等需要强大通用计算能力的设备中。
* **80-20 规律**：在实际程序中，往往 80% 的执行时间仅使用了 20% 的基础指令。CISC 试图通过提供更复杂的指令来优化这 20% 的使用频率较低但功能强大的指令。
* **实现案例**：如果在设计一个既包含整数运算又包含矩阵运算的指令集时，CISC 会倾向于单独提供**矩阵加/减/乘**等复杂指令。

#### 2.2 RISC (Reduced Instruction Set Computer) (01:30)

* **全称**：**R**educed **I**nstruction **S**et **C**omputer（精简指令集计算机）。
* **设计理念**：
    * **基础指令**：仅提供最基本、最常用的操作指令（如简单的加、减、乘、除、数据加载和存储）。
    * **组合实现**：复杂功能通过**多条基础指令组合**来完成，依赖编译器将高级语言的复杂操作分解为多条 RISC 指令。
* **典型应用**：**ARM 架构**是 RISC 的典型代表，广泛应用于智能手机、平板电脑等对功耗和体积有严格要求的移动设备。
* **优势体现**：
    * **低功耗**：由于指令集简单，硬件电路设计也更简单，从而降低了能耗。
    * **并行优势**：由于大多数指令的执行时间相近且固定，这非常有利于实现**指令流水线技术**，提高指令的吞吐率。
* **实现案例**：要实现矩阵运算，RISC 会将其分解为多个**元素级的基础运算**（如逐个元素的加载、乘法、加法、存储）组合来完成。

#### 2.3 CISC 和 RISC 的对比 (07:27)

| 特性         | CISC (复杂指令集计算机)                               | RISC (精简指令集计算机)                                |
| :----------- | :---------------------------------------------------- | :----------------------------------------------------- |
| **系统复杂度** | 指令系统复杂庞大（通常 >200 条），功能丰富。          | 指令系统简单精简（通常 <100 条），只包含基础功能。     |
| **指令特性** |                                                       |                                                        |
|  字长 | **不固定**，指令长度可变。                            | **定长设计**，所有指令长度一致。                       |
|  访存限制 | **允许任意指令直接访问内存**（例如乘法指令可以直接操作内存中的数据）。 | **严格限定只有 `Load` / `Store` 指令可访问内存**（所有运算都在寄存器中进行）。 |
| **执行效率** |                                                       |                                                        |
| 周期时间 | 单条指令的执行周期时间差异大。                        | 大多数指令可在**单周期**内完成。                       |
| 使用频度 | 指令使用频度差异显著（部分复杂指令很少用）。          | 所有指令均常用，没有冗余。                             |
| **硬件设计** |                                                       |                                                        |
| 寄存器数量 | 通用寄存器数量通常较少。                              | 需要**更多通用寄存器**来暂存中间结果。                 |
| 控制方式 | 多采用**微程序控制**（通过微指令序列实现复杂指令）。 | 多采用**组合逻辑控制**（硬连线控制）。                 |
| **优化潜力** |                                                       |                                                        |
| 代码生成 | 编译器生成高效代码较困难。                            | 更易通过**编译优化**生成高效代码。                     |
|  流水线实现 | 流水线实现较困难。                                    | 天然适合且**必须**实现指令流水线，以提高性能。         |

* **典型区别案例**：
    * 包含**直接访存的乘法指令**（如 `MUL AX, [BX]`）必定属于 **CISC 架构**，因为 RISC 架构要求访存必须通过专用的 `Load` / `Store` 指令完成（即先 `Load` 到寄存器，再 `MUL` 寄存器，最后 `Store` 回内存）。
    * **寄存器使用**：RISC 需要更多寄存器来暂存中间结果，以减少对内存的访问；而 CISC 可以通过复杂指令（如直接操作内存的指令）减少对寄存器的占用。