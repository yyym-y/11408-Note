# 指令寻址

指令寻址是处理器如何确定下一条要执行的指令在哪里的过程。

### 1. 顺序寻址

**基本概念**: 顺序寻址是通过**程序计数器 (PC) 的自动递增来确定下一条指令的地址**。

* **“1”的含义**: PC 自动加“1”中的“1”并不是简单的数值1。它表示的是**当前指令的字长**。
* **实际增加值取决于指令长度和编址方式**:
    * **定长指令字 + 按字编址**: 如果所有指令的长度相同，并且内存是按字进行编址（每个地址对应一个字），那么 PC 每次会加 **1**。
    * **定长指令字 + 按字节编址**: 如果所有指令的长度相同，但内存是按字节进行编址（每个地址对应一个字节），而一条指令占据多个字节（例如，2字节），那么 PC 每次会加**指令所占的字节数**（例如，PC + 2）。
    * **变长指令字**: 如果指令的长度不固定，PC 的增加就更复杂了。CPU 需要先读取指令的**第一个字（或一部分）**来判断当前指令的类型和**总长度 $$n$$**，然后 PC 才会增加 $$n$$。

* **变长指令处理流程**:
    1.  **读取第一个存储字获取操作码**: CPU 从 PC 指向的地址读取指令的第一个存储字。
    2.  **判断指令类型和长度**: 根据读取到的操作码，CPU 判断出这条指令的完整类型和它所占用的总字节数。
    3.  **多次访存（可能）**: 如果指令很长，可能需要进行多次内存访问才能获取完整的指令。
    4.  **PC增加值为指令总字节数**: 完成指令的获取后，PC 会增加这条指令的总字节数，指向下一条指令的起始地址。

### 2. 跳跃寻址

**实现方式**: 跳跃寻址是通过执行**转移指令**（如 `JMP`、`CALL`、`RET` 等）来**直接修改 PC 的值**，从而改变程序的正常执行流程。

* **特点**:
    * 它**改变了程序正常的顺序执行流程**。
    * 类似于高级语言中的 `goto` 语句、函数调用或条件判断。
    * 执行转移指令后，PC 不再简单地自动递增。

* **示例分析**:
    假设程序执行到地址为3的指令 `JMP 7`（跳转到地址7）。
    1.  **取指阶段**: CPU 从地址3取出 `JMP 7` 指令。此时，PC 已经**自动自增到4**，指向了地址4。
    2.  **执行阶段**: 在执行 `JMP 7` 指令时，CPU 会强制将 PC 的值**修改为7**。 (实际上会根据跳转指令的不同来处理原本的PC值， 如果是JUP就丢弃， 如果是CALL就将原PC地址压入到栈中)
    3.  **下一条指令**: 因此，下一条指令将从地址7开始执行，而不是地址4。

---


## 五、知识小结

| 知识点            | 核心内容                                                  | 考试重点/易混淆点                                         | 难度系数 |
| :---------------- | :-------------------------------------------------------- | :-------------------------------------------------------- | :------- |
| **指令的组成** | 指令分为**操作码**和**地址码**两部分，地址码可能有多个。 | **区分操作码和地址码的功能**。                          | ⭐⭐      |
| **指令的存储方式** | 高级语言程序最终转换为机器指令，**顺序存放在主存中**。    | **指令在主存中的存放规则**。                            | ⭐⭐      |
| **指令寻址的基本原理** | 通过**程序计数器 (PC)** 确定下一条指令的地址。          | **PC 的作用及自动加一机制**。                           | ⭐⭐⭐     |
| **顺序寻址** | PC **自动加一**（“加一”取决于指令字长和编址方式）。     | **“加一”的实际含义**（按字/按字节编址）。                 | ⭐⭐⭐     |
| **定长指令字结构下的寻址** | 指令字长固定，PC 按固定增量（如加1或加2）寻址。         | **主存编址方式（字/字节）对 PC 增量的影响**。           | ⭐⭐⭐     |
| **变长指令字结构下的寻址** | 指令字长不固定，需先读取操作码判断指令长度。            | **多字节指令的多次访存问题**。                          | ⭐⭐⭐⭐   |
| **跳跃寻址** | 通过**转移指令**（如 `JMP`）直接修改 PC 值，改变执行流。 | **无条件转移与条件转移的区别**。                        | ⭐⭐⭐⭐   |
| **程序计数器（PC）的核心作用** | PC **始终指向下一条待执行指令的地址**。                 | **PC 的修改时机**（取指后 vs. 执行转移指令后）。        | ⭐⭐⭐     |
| **指令执行流程** | 取指 $\rightarrow$ PC 自动增量 $\rightarrow$ 执行 $\rightarrow$ 根据 PC 取下一指令。 | **转移指令对 PC 的强制修改**。                          | ⭐⭐⭐⭐   |