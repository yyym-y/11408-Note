# 虚拟机

* 虚拟机
	* 虚拟机：使用虚拟化技术，将一台物理机器虚拟化为多台虚拟机，每个虚拟机器都可以独立运行一个操作系统
	* 第一类虚拟机管理程序
		* ![Pasted image 20250523143455.png](./img/Pasted%20image%2020250523143455.png)
		* 直接运行在硬件之上，能直接控制和分配物理资源
		* 在安装GuestOS时，VMM要在原本的硬盘上自行分配存储空间，类似于"外核"的分配方式，分配未经抽象的物理硬件，性能更好
		* 第一类VMM运行在最高特权级(Ring0），可以执行最高特权的指令（特权指令也被分成了很多级，如果是一些级别较低的特权指令，那么虚拟机管理程序可以不用检查，从而提高性能）
		* 缺点：虚拟机的迁移性较差
	* 第二类虚拟机管理程序
		* ![Pasted image 20250523143508.png](./img/Pasted%20image%2020250523143508.png)
		* 运行在HostOS之上，依赖于HostOS为其分配物理资源
		* GuestOS拥有自己的虚拟磁盘，该盘实际上是HostOS文件系统中的一个大文件。GuestOS分配到的内存是虚拟内存性能更差，要经过宿主操作系统的中介
		* 支持的虚拟机数量比第一类要少
		* 虚拟机的迁移非常方便
		* 第二类VMM部分运行在用户态、部分运行在内核态（驱动程序）。GuestOS发出的系统调用会被VMM截获，并转化为VMM对HostOS的系统调用